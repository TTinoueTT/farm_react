# TDD 開発のサンプル

## 開発の流れ

1. テストを書く
2. テストに失敗する処理の実装
3. テストを実行する(Red)
4. テストに成功する処理の実装
5. テストを実行する(Green)
6. リファクタリング

### テストが動くかの確認

components/Input/TextInput.test.tsx と components/Input/TextInput.tsx で動作確認はできています。

### テストファイルの配置を `__tests__` にする理由

テストファイルは `__tests__` に配置することで、テストファイルを識別しやすくなります。

動作確認含めて、__tests__ フォルダー内のテストファイルを実行してみます。
```tsx: src/__tests__/FizzBuzz.test.tsx
it.todo("FizzBuzz テスト")
```

vitest のコマンドでテストを実行します。

```bash
npm run test src/__tests__/FizzBuzz.test.tsx 

> farm_react@0.0.0 test
> vitest src/__tests__/FizzBuzz.test.tsx


 DEV  v3.1.1 /Users/farm_react

 ↓ src/__tests__/FizzBuzz.test.tsx (1 test | 1 skipped)
   ↓ FizzBuzz テスト

 Test Files  1 skipped (1)
      Tests  1 todo (1)
   Start at  12:46:42
   Duration  337ms (transform 12ms, setup 77ms, collect 3ms, tests 0ms, environment 135ms, prepare 32ms)

 PASS  Waiting for file changes...
       press h to show help, press q to quit
```
vitest がテストファイルの変更を検知して、テストを実行します。
`it.todo` はテストのプレースホルダーなので、実装はされず、実際にはテストが実行されていません。
結果として、テストファイルは「スキップされた（もしくは未実装の状態）」と表示され、1件の `todo` テストが登録された状態になっています。
また、テスト実行後はウォッチモードになり、`「Waiting for file changes...」`と表示され、ファイルの変更を待っています。

## テストの種類

フロントエンドにおけるテストは以下に分類されます。

| テストの種類 | 説明 |
| ------------ | ---- |
| 単体テスト | 単体テストは、関数やメソッドが正しく動作するかを確認するテストです。 |
| 結合テスト | 結合テストは、複数の関数やメソッドが正しく連携して動作するかを確認するテストです。 |
| システムテスト | システムテストは、システム全体が正しく動作するかを確認するテストです。 |
| スナップショットテスト | スナップショットテストは、UIのスナップショットを撮り、それが正しいかを確認するテストです。 |
| インテグレーションテスト | インテグレーションテストは、複数のシステムが正しく連携して動作するかを確認するテストです。 |
| エンドツーエンドテスト | エンドツーエンドテストは、システム全体が正しく動作するかを確認するテストです。 |

コンポーネント単体のテストでは、個々の関数だけでなく、UIのレンダリングや内部状態、イベントハンドリングなど複数の要素が連携して動作することを検証します。


## Fizz Buzz 要件

### 要件

1. 1 から 100 までの数字を入力する
2. 3 の倍数の場合は Fizz と出力する
3. 5 の倍数の場合は Buzz と出力する
4. 3 と 5 の倍数の場合は Fizz Buzz と出力する
5. それ以外の数字を入力したら、そのまま出力エリアに表示する

### テストコード
この要件をテストコードに実行します。まずはスキップするテストを作成します。
```ts
// 要件
describe("Fizz Buzz 問題の答えを表示する", () => {
	// 仕様
	it.todo("1 から 100 までの数字を入力する")
	it.todo('入力エリアに 3 の倍数を入力したら、出力エリアに "Fizz" を表示する')
	it.todo('入力エリアに 5 の倍数を入力したら、出力エリアに "Buzz" を表示する')
	it.todo(
		'ただし、入力エリアに 3 と 5 の倍数を入力したら、出力エリアに "Fizz Buzz" を表示する'
	)
	it.todo("それ以外の数字を入力したら、そのまま出力エリアに表示する")
})
```
vitest がテストファイルの検知をして、テスト実行されていれば OK です。

```bash
npm run test src/__tests__/FizzBuzz.test.tsx

 ↓ src/__tests__/FizzBuzz.test.tsx (5 tests | 5 skipped)
   ↓ Fizz Buzz 問題の答えを表示する > 1 から 100 までの数字を入力する
   ↓ Fizz Buzz 問題の答えを表示する > 入力エリアに 3 の倍数を入力したら、出力エリアに "Fizz" を表示する
   ↓ Fizz Buzz 問題の答えを表示する > 入力エリアに 5 の倍数を入力したら、出力エリアに "Buzz" を表示する
   ↓ Fizz Buzz 問題の答えを表示する > ただし、入力エリアに 3 と 5 の倍数を入力したら、出力エリアに "Fizz Buzz" を表示する
   ↓ Fizz Buzz 問題の答えを表示する > それ以外の数字を入力したら、そのまま出力エリアに表示する

 Test Files  1 skipped (1)
      Tests  5 todo (5)
   Start at  12:53:49
   Duration  32ms

 PASS  Waiting for file changes...
```

テストを書く順番は、テスト容易性が高くて、重要度も高いものから書いていきます。

- テスト容易性が高い
  - テストが簡単に書ける、または初期段階で実装しやすい部分。
- 重要度が高い
  - アプリケーションのコアな機能、または不具合が発生すると大きな影響を与える部分。

つまり、まずは実装に直接影響する重要なロジックを確実にカバーできるよう、テストしやすい部分からテストを作成し、徐々に他の部分のテストを追加していくというアプローチを示しています。



